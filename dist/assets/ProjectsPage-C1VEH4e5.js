import{u as z,_ as q,d as X,b as E,c as Y,a as Z}from"./useUsers-DIK48TWR.js";import{d as T,r as i,o as g,c as h,w as p,l as k,m as I,a as o,f as m,t as C,F as O,j as N,g as U,u as d,B as S,q as A,_ as L,i as D,C as ee}from"./index-By11hEvf.js";import{u as te}from"./useModal-f96_iVK_.js";import{u as oe}from"./useToast-CWDGN--A.js";import"./utils-Blx_SZM_.js";const M=T({__name:"ProjectStatusBadge",props:{status:{type:String,required:!0}},setup(b){const _={"in progress":"primary",archived:"secondary",completed:"success",important:"warning"};return(u,v)=>{const n=i("VaBadge");return g(),h(n,{square:"",color:_[u.$props.status],text:u.$props.status.toUpperCase()},null,8,["color","text"])}}}),ae={class:"text-[var(--va-secondary)]"},se={class:"flex flex-col items-center gap-4 grow"},le={class:"va-h4 text-center self-stretch overflow-hidden line-clamp-2 text-ellipsis"},ne={class:"flex justify-between"},re={key:1,class:"p-4 flex justify-center items-center text-[var(--va-secondary)]"},ie=T({__name:"ProjectCards",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0}},emits:["edit","delete"],setup(b){const _=u=>{const v=["primary","#FFD43A","#ADFF00","#262824","danger"],n=u.charCodeAt(0)%v.length;return v[n]};return(u,v)=>{const n=i("VaAvatarGroup"),$=i("VaDivider"),V=i("VaButton"),j=i("VaCardContent"),y=i("VaCard"),r=i("VaInnerLoading");return b.projects.length>0||b.loading?(g(),h(r,{key:0,loading:b.loading,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 min-h-[4rem]"},{default:p(()=>[(g(!0),k(O,null,I(b.projects,e=>(g(),h(y,{key:e.project_name,style:{"--va-card-outlined-border":"1px solid var(--va-background-element)"},outlined:""},{default:p(()=>[o(j,{class:"flex flex-col h-full"},{default:p(()=>[m("div",ae,C(e.creation_date),1),m("div",se,[m("h4",le,C(e.project_name),1),m("p",null,[v[0]||(v[0]=m("span",{class:"text-[var(--va-secondary)]"},"Owner: ",-1)),m("span",null,C(e.project_owner.fullname),1)]),o(n,{class:"my-4",options:e.team.map(l=>({label:l.fullname,src:l.avatar,fallbackText:l.fullname[0],color:_(l.fullname)})),max:5},null,8,["options"]),o(M,{status:e.status},null,8,["status"])]),o($,{class:"my-6"}),m("div",ne,[o(V,{preset:"secondary",icon:"mso-edit",color:"secondary",onClick:l=>u.$emit("edit",e)},null,8,["onClick"]),o(V,{preset:"secondary",icon:"mso-delete",color:"danger",onClick:l=>u.$emit("delete",e)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["loading"])):(g(),k("div",re,"No projects"))}}}),de={class:"ellipsis max-w-[230px] lg:max-w-[450px]"},ue={class:"flex items-center gap-2 ellipsis max-w-[230px]"},ce={class:"flex gap-2 justify-end"},pe={class:"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2"},me={key:0,class:"flex"},ge=T({__name:"ProjectsTable",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0},sortBy:{type:Object,required:!0},sortingOrder:{type:Object,required:!0},pagination:{type:Object,required:!0}},emits:["edit","delete"],setup(b,{emit:_}){const u=X([{label:"Project name",key:"project_name",sortable:!0},{label:"Project owner",key:"project_owner",sortable:!0},{label:"Team",key:"team",sortable:!0},{label:"Status",key:"status",sortable:!0},{label:"Creation Date",key:"creation_date",sortable:!0},{label:" ",key:"actions"}]),v=b,n=_,$=r=>{const e=["primary","#FFD43A","#ADFF00","#262824","danger"],l=r.charCodeAt(0)%e.length;return e[l]},V=z(v,"sortBy",n),j=z(v,"sortingOrder",n),y=N(()=>Math.ceil(v.pagination.total/v.pagination.perPage));return(r,e)=>{const l=i("VaAvatarGroup"),a=i("VaButton"),P=i("VaDataTable"),B=i("VaSelect"),F=i("VaPagination");return g(),k("div",null,[o(P,{"sort-by":d(V),"onUpdate:sortBy":e[0]||(e[0]=s=>S(V)?V.value=s:null),"sorting-order":d(j),"onUpdate:sortingOrder":e[1]||(e[1]=s=>S(j)?j.value=s:null),items:b.projects,columns:d(u),loading:b.loading},{"cell(project_name)":p(({rowData:s})=>[m("div",de,C(s.project_name),1)]),"cell(project_owner)":p(({rowData:s})=>[m("div",ue,[o(q,{user:s.project_owner,size:"small"},null,8,["user"]),U(" "+C(s.project_owner.fullname),1)])]),"cell(team)":p(({rowData:s})=>[o(l,{size:"small",options:s.team.map(x=>({label:x.fullname,src:x.avatar,fallbackText:x.fullname[0],color:$(x.fullname)})),max:5},null,8,["options"])]),"cell(status)":p(({rowData:s})=>[o(M,{status:s.status},null,8,["status"])]),"cell(actions)":p(({rowData:s})=>[m("div",ce,[o(a,{preset:"primary",size:"small",color:"primary",icon:"mso-edit","aria-label":"Edit project",onClick:x=>r.$emit("edit",s)},null,8,["onClick"]),o(a,{preset:"primary",size:"small",icon:"mso-delete",color:"danger","aria-label":"Delete project",onClick:x=>r.$emit("delete",s)},null,8,["onClick"])])]),_:1},8,["sort-by","sorting-order","items","columns","loading"]),m("div",pe,[m("div",null,[m("b",null,C(r.$props.pagination.total)+" results.",1),e[6]||(e[6]=U(" Results per page ")),o(B,{modelValue:r.$props.pagination.perPage,"onUpdate:modelValue":e[2]||(e[2]=s=>r.$props.pagination.perPage=s),class:"!w-20",options:[10,50,100]},null,8,["modelValue"])]),y.value>1?(g(),k("div",me,[o(a,{preset:"secondary",icon:"va-arrow-left","aria-label":"Previous page",disabled:r.$props.pagination.page===1,onClick:e[3]||(e[3]=s=>r.$props.pagination.page--)},null,8,["disabled"]),o(a,{class:"mr-2",preset:"secondary",icon:"va-arrow-right","aria-label":"Next page",disabled:r.$props.pagination.page===y.value,onClick:e[4]||(e[4]=s=>r.$props.pagination.page++)},null,8,["disabled"]),o(F,{modelValue:r.$props.pagination.page,"onUpdate:modelValue":e[5]||(e[5]=s=>r.$props.pagination.page=s),"buttons-preset":"secondary",pages:y.value,"visible-pages":5,"boundary-links":!1,"direction-links":!1},null,8,["modelValue","pages"])])):A("",!0)])])}}}),ve=L(ge,[["__scopeId","data-v-6b0380a6"]]),fe={class:"flex justify-end flex-col-reverse sm:flex-row mt-4 gap-2"},ye=T({__name:"EditProjectForm",props:{project:{},saveButtonLabel:{}},emits:["save","close"],setup(b,{expose:_}){const u=b,v={project_name:"",project_owner:void 0,team:[],status:void 0},n=D({...v}),$=N(()=>Object.keys(n.value).some(l=>{var a;return l==="team"?!1:n.value[l]!==((a=u.project??v)==null?void 0:a[l])}));_({isFormHasUnsavedChanges:$}),ee(()=>u.project,()=>{u.project&&(n.value={...u.project,project_owner:u.project.project_owner})},{immediate:!0});const V=l=>!!l||"This field is required",{users:j,filters:y}=E({pagination:D({page:1,perPage:100,total:10})}),{users:r,filters:e}=E({pagination:D({page:1,perPage:100,total:10})});return(l,a)=>{const P=i("VaInput"),B=i("VaSelect"),F=i("VaButton"),s=i("VaForm");return g(),h(s,{class:"flex flex-col gap-2"},{default:p(({validate:x})=>[o(P,{modelValue:n.value.project_name,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.project_name=t),label:"Project name",rules:[V]},null,8,["modelValue","rules"]),o(B,{modelValue:n.value.project_owner,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.project_owner=t),search:d(e).search,"onUpdate:search":a[2]||(a[2]=t=>d(e).search=t),searchable:"",label:"Owner","text-by":"fullname","track-by":"id",rules:[V],options:d(r)},{content:p(({value:t})=>[t?(g(),k("div",{key:t.id,class:"flex items-center gap-1 mr-4"},[o(q,{user:t,size:"18px"},null,8,["user"]),U(" "+C(t.fullname),1)])):A("",!0)]),_:1},8,["modelValue","search","rules","options"]),o(B,{modelValue:n.value.team,"onUpdate:modelValue":a[3]||(a[3]=t=>n.value.team=t),search:d(y).search,"onUpdate:search":a[4]||(a[4]=t=>d(y).search=t),label:"Team","text-by":"fullname","track-by":"id",multiple:"",rules:[t=>"length"in t&&t.length>0||"This field is required"],options:d(j),"max-visible-options":l.$vaBreakpoint.mdUp?3:1},{content:p(({valueArray:t})=>[t?(g(!0),k(O,{key:0},I(t,(f,c)=>(g(),k("div",{key:f.id,class:"flex items-center gap-1 mr-2"},[o(q,{user:f,size:"18px"},null,8,["user"]),U(" "+C(f.fullname)+C(c<t.length-1?",":""),1)]))),128)):A("",!0)]),_:1},8,["modelValue","search","rules","options","max-visible-options"]),o(B,{modelValue:n.value.status,"onUpdate:modelValue":a[5]||(a[5]=t=>n.value.status=t),label:"Status",rules:[V],"track-by":"value","value-by":"value",options:[{text:"In progress",value:"in progress"},{text:"Archived",value:"archived"},{text:"Completed",value:"completed"},{text:"Important",value:"important"}]},{content:p(({value:t})=>[t?(g(),h(M,{key:0,status:t.value},null,8,["status"])):A("",!0)]),_:1},8,["modelValue","rules"]),m("div",fe,[o(F,{preset:"secondary",color:"secondary",onClick:a[6]||(a[6]=t=>l.$emit("close"))},{default:p(()=>a[7]||(a[7]=[U("Cancel")])),_:1}),o(F,{onClick:t=>x()&&l.$emit("save",n.value)},{default:p(()=>[U(C(l.saveButtonLabel),1)]),_:2},1032,["onClick"])])]),_:1})}}}),be=L(ye,[["__scopeId","data-v-cc1c112b"]]),_e={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},Ve={class:"flex flex-col md:flex-row gap-2 justify-start"},je={key:0,class:"va-h5 mb-4"},xe={key:1,class:"va-h5 mb-4"},Be=T({__name:"ProjectsPage",setup(b){const _=Y("projects-view",!0),{projects:u,update:v,add:n,isLoading:$,remove:V,pagination:j,sorting:y}=Z(),r=D(null),e=D(!1),l=f=>{r.value=f,e.value=!0},a=()=>{r.value=null,e.value=!0},{init:P}=oe(),B=async f=>{e.value=!1,"id"in f?(await v(f),P({message:"Project updated",color:"success"})):(await n(f),P({message:"Project created",color:"success"}))},{confirm:F}=te(),s=async f=>{await F({title:"Delete project",message:`Are you sure you want to delete project "${f.project_name}"?`,okText:"Delete",size:"small",maxWidth:"380px"})&&(await V(f),P({message:"Project deleted",color:"success"}))},x=D(),t=async f=>{x.value.isFormHasUnsavedChanges?await F({maxWidth:"380px",message:"Form has unsaved changes. Are you sure you want to close it?",size:"small"})&&f():f()};return(f,c)=>{const G=i("VaButtonToggle"),R=i("VaButton"),H=i("VaCardContent"),W=i("VaModal"),J=i("VaCard");return g(),k(O,null,[c[6]||(c[6]=m("h1",{class:"page-title"},"Projects",-1)),o(J,null,{default:p(()=>[o(H,null,{default:p(()=>[m("div",_e,[m("div",Ve,[o(G,{modelValue:d(_),"onUpdate:modelValue":c[0]||(c[0]=w=>S(_)?_.value=w:null),color:"background-element","border-color":"background-element",options:[{label:"Cards",value:!0},{label:"Table",value:!1}]},null,8,["modelValue"])]),o(R,{icon:"add",onClick:a},{default:p(()=>c[5]||(c[5]=[U("Project")])),_:1})]),d(_)?(g(),h(ie,{key:0,projects:d(u),loading:d($),onEdit:l,onDelete:s},null,8,["projects","loading"])):(g(),h(ve,{key:1,"sort-by":d(y).sortBy,"onUpdate:sortBy":c[1]||(c[1]=w=>d(y).sortBy=w),"sorting-order":d(y).sortingOrder,"onUpdate:sortingOrder":c[2]||(c[2]=w=>d(y).sortingOrder=w),pagination:d(j),"onUpdate:pagination":c[3]||(c[3]=w=>S(j)?j.value=w:null),projects:d(u),loading:d($),onEdit:l,onDelete:s},null,8,["sort-by","sorting-order","pagination","projects","loading"]))]),_:1}),o(W,{modelValue:e.value,"onUpdate:modelValue":c[4]||(c[4]=w=>e.value=w),size:"small","mobile-fullscreen":"","close-button":"",stateful:"","hide-default-actions":"","before-cancel":t},{default:p(({cancel:w,ok:K})=>[r.value===null?(g(),k("h1",je,"Add project")):(g(),k("h1",xe,"Edit project")),o(be,{ref_key:"editFormRef",ref:x,project:r.value,"save-button-label":r.value===null?"Add":"Save",onClose:w,onSave:Q=>{B(Q),K()}},null,8,["project","save-button-label","onClose","onSave"])]),_:1},8,["modelValue"])]),_:1})],64)}}});export{Be as default};
//# sourceMappingURL=ProjectsPage-C1VEH4e5.js.map
