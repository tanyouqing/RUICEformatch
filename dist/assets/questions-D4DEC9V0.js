import{_ as u,l as o,f as l,L as p,T as w,g as y,q as h,F as m,m as g,o as a}from"./index-By11hEvf.js";const f={data(){return{searchQuery:"",answers:[],displayedAnswers:[],loading:!1,error:!1,isEmptyMessage:!1,hasMore:!0,page:1,pageSize:5,cache:{},stream:!0}},methods:{async search(){this.error=!1,this.isEmptyMessage=!1,this.loading=!0,this.answers=[];const t=this.searchQuery.trim();if(t===""){this.isEmptyMessage=!0,this.loading=!1;return}if(this.cache[t]){this.answers=this.cache[t],this.updateDisplayedAnswers(),this.loading=!1;return}try{const e=await this.fetchAnswer(t);if(e&&e.choices){const i=e.choices.map(c=>c.message.content);this.answers=this.answers.concat(i),this.cache[t]=this.answers,this.updateDisplayedAnswers()}else this.answers=[]}catch(e){this.error=!0,console.error("Error fetching answer:",e)}this.loading=!1},async fetchAnswer(t){const e="sk-RqoBIoExUi2dHOHK0Fv7kyQofalZwKWzi29Dk95F4dZNANCN",i="https://api.moonshot.cn/v1/chat/completions",c={Authorization:`Bearer ${e}`,"Content-Type":"application/json"},s={model:"moonshot-v1-8k",messages:[{role:"system",content:"你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。"},{role:"user",content:t}],temperature:.3};try{const r=await fetch(i,{method:"POST",headers:c,body:JSON.stringify(s)});if(!r.ok)throw new Error("Network response was not ok");return await r.json()}catch(r){return console.error("Error fetching answer:",r),{choices:[]}}},updateDisplayedAnswers(){this.displayedAnswers=this.answers.slice(0,this.pageSize*this.page)},loadMore(){if(this.answers.length<=this.displayedAnswers.length){this.hasMore=!1;return}this.updateDisplayedAnswers()},clearAnswers(){this.answers=[],this.displayedAnswers=[]},parseMarkdown(t){const e=/\*\*(.*?)\*\*/g,i=t.replace(e,"<strong>\\$1</strong>");return new DOMParser().parseFromString(i,"text/html").body.innerHTML}}},k={class:"search-container"},_={class:"search-box"},M=["disabled"],A=["disabled"],b={key:0,class:"loading"},v={key:1,class:"error"},x={key:2,class:"empty-message"},E={key:3,class:"answers-container"},N=["innerHTML"];function T(t,e,i,c,s,r){return a(),o("section",k,[l("div",_,[p(l("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.searchQuery=n),type:"text",placeholder:"请输入您的问题...",class:"search-input",disabled:s.loading,onInput:e[1]||(e[1]=(...n)=>r.clearAnswers&&r.clearAnswers(...n))},null,40,M),[[w,s.searchQuery]]),l("button",{class:"search-button",disabled:s.loading||!s.searchQuery.trim(),onClick:e[2]||(e[2]=(...n)=>r.search&&r.search(...n))},"搜索",8,A)]),s.loading?(a(),o("div",b,e[4]||(e[4]=[l("div",{class:"spinner"},null,-1),y(" 正在搜索... ")]))):h("",!0),s.error?(a(),o("div",v,"抱歉，搜索出错，请稍后再试。")):h("",!0),s.isEmptyMessage?(a(),o("div",x,"请输入内容后再进行搜索")):h("",!0),s.answers.length>0?(a(),o("div",E,[(a(!0),o(m,null,g(s.displayedAnswers,(n,d)=>(a(),o("article",{key:d,class:"answer"},[l("div",{innerHTML:r.parseMarkdown(n)},null,8,N)]))),128)),s.hasMore?(a(),o("button",{key:0,class:"load-more-button",onClick:e[3]||(e[3]=(...n)=>r.loadMore&&r.loadMore(...n))},"加载更多")):h("",!0)])):h("",!0)])}const Q=u(f,[["render",T],["__scopeId","data-v-db7e0492"]]);export{Q as default};
//# sourceMappingURL=questions-D4DEC9V0.js.map
