{"version":3,"file":"questions-D4DEC9V0.js","sources":["../../src/pages/faq/questions.vue"],"sourcesContent":["<template>\n  <section class=\"search-container\">\n    <div class=\"search-box\">\n      <input\n        v-model=\"searchQuery\"\n        type=\"text\"\n        placeholder=\"请输入您的问题...\"\n        class=\"search-input\"\n        :disabled=\"loading\"\n        @input=\"clearAnswers\"\n      />\n      <button class=\"search-button\" :disabled=\"loading || !searchQuery.trim()\" @click=\"search\">搜索</button>\n    </div>\n\n    <!-- 显示加载中的提示 -->\n    <div v-if=\"loading\" class=\"loading\">\n      <div class=\"spinner\"></div>\n      正在搜索...\n    </div>\n\n    <!-- 显示错误信息 -->\n    <div v-if=\"error\" class=\"error\">抱歉，搜索出错，请稍后再试。</div>\n\n    <!-- 显示空输入提示 -->\n    <div v-if=\"isEmptyMessage\" class=\"empty-message\">请输入内容后再进行搜索</div>\n\n    <!-- 显示答案 -->\n    <div v-if=\"answers.length > 0\" class=\"answers-container\">\n      <article v-for=\"(answer, index) in displayedAnswers\" :key=\"index\" class=\"answer\">\n        <!-- eslint-disable vue/no-v-html -->\n        <div v-html=\"parseMarkdown(answer)\"></div>\n      </article>\n\n      <!-- 加载更多按钮 -->\n      <button v-if=\"hasMore\" class=\"load-more-button\" @click=\"loadMore\">加载更多</button>\n    </div>\n  </section>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      searchQuery: '',\n      answers: [],\n      displayedAnswers: [],\n      loading: false,\n      error: false,\n      isEmptyMessage: false,\n      hasMore: true,\n      page: 1,\n      pageSize: 5,\n      cache: {},\n      stream: true,\n    }\n  },\n  methods: {\n    async search() {\n      this.error = false\n      this.isEmptyMessage = false\n      this.loading = true\n      this.answers = [] // 清空上一次的回答\n\n      const trimmedQuery = this.searchQuery.trim()\n\n      if (trimmedQuery === '') {\n        this.isEmptyMessage = true\n        this.loading = false\n        return\n      }\n\n      if (this.cache[trimmedQuery]) {\n        this.answers = this.cache[trimmedQuery]\n        this.updateDisplayedAnswers()\n        this.loading = false\n        return\n      }\n\n      try {\n        const response = await this.fetchAnswer(trimmedQuery)\n        if (response && response.choices) {\n          const choiceContents = response.choices.map((choice) => choice.message.content)\n          this.answers = this.answers.concat(choiceContents)\n          this.cache[trimmedQuery] = this.answers\n          this.updateDisplayedAnswers()\n        } else {\n          this.answers = []\n        }\n      } catch (error) {\n        this.error = true\n        console.error('Error fetching answer:', error)\n      }\n      this.loading = false\n    },\n    async fetchAnswer(query) {\n      const apiKey = 'sk-RqoBIoExUi2dHOHK0Fv7kyQofalZwKWzi29Dk95F4dZNANCN' // 替换为你的 API Key\n      const url = 'https://api.moonshot.cn/v1/chat/completions'\n      const headers = {\n        Authorization: `Bearer ${apiKey}`,\n        'Content-Type': 'application/json',\n      }\n\n      const data = {\n        model: 'moonshot-v1-8k',\n        messages: [\n          { role: 'system', content: '你是 Kimi，由 Moonshot AI 提供的人工智能助手，你更擅长中文和英文的对话。' },\n          { role: 'user', content: query },\n        ],\n        temperature: 0.3,\n      }\n\n      try {\n        const response = await fetch(url, {\n          method: 'POST',\n          headers: headers,\n          body: JSON.stringify(data),\n        })\n        if (!response.ok) throw new Error('Network response was not ok')\n        const result = await response.json()\n        return result\n      } catch (error) {\n        console.error('Error fetching answer:', error)\n        return { choices: [] }\n      }\n    },\n    updateDisplayedAnswers() {\n      this.displayedAnswers = this.answers.slice(0, this.pageSize * this.page)\n    },\n    loadMore() {\n      if (this.answers.length <= this.displayedAnswers.length) {\n        this.hasMore = false\n        return\n      }\n      this.updateDisplayedAnswers()\n    },\n    clearAnswers() {\n      this.answers = []\n      this.displayedAnswers = []\n    },\n    parseMarkdown(markdownText) {\n      const boldRegex = /\\*\\*(.*?)\\*\\*/g\n      const html = markdownText.replace(boldRegex, '<strong>\\\\$1</strong>')\n      const parser = new DOMParser()\n      const doc = parser.parseFromString(html, 'text/html')\n      return doc.body.innerHTML\n    },\n  },\n}\n</script>\n\n<style scoped>\n/* 基础颜色变量 */\n:root {\n  --primary-color: #007bff;\n  --secondary-color: #0056b3;\n  --success-color: #28a745;\n  --warning-color: orange;\n  --error-color: red;\n  --background-color: #f7f7f7;\n}\n\n/* 页面容器 */\n.search-container {\n  max-width: 700px;\n  margin: 0 auto;\n  padding: 20px;\n  background-color: var(--background-color);\n  border-radius: 10px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n}\n\n/* 输入框容器 */\n.search-box {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.search-input {\n  width: 80%;\n  padding: 12px;\n  margin-right: 10px;\n  border: 2px solid var(--primary-color);\n  border-radius: 8px;\n  font-size: 16px;\n  transition: border-color 0.3s;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--secondary-color);\n}\n\n.search-button {\n  width: 18%;\n  padding: 12px;\n  background-color: var(--primary-color);\n  color: #154ec1;\n  border: none;\n  border-radius: 8px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.search-button:disabled {\n  background-color: #dcdcdc;\n  cursor: not-allowed;\n}\n\n.search-button:hover:enabled {\n  background-color: var(--secondary-color);\n}\n\n.loading {\n  text-align: center;\n  margin-top: 20px;\n  color: #007bff;\n  font-size: 18px;\n}\n\n.spinner {\n  display: inline-block;\n  width: 24px;\n  height: 24px;\n  border: 4px solid transparent;\n  border-top: 4px solid #007bff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.error {\n  text-align: center;\n  margin-top: 20px;\n  color: var(--error-color);\n  font-size: 18px;\n}\n\n.empty-message {\n  text-align: center;\n  margin-top: 20px;\n  color: var(--warning-color);\n  font-size: 18px;\n}\n\n/* 回答区样式 */\n.answers-container {\n  margin-top: 20px;\n}\n\n.answer {\n  margin-bottom: 15px;\n  padding: 15px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  background-color: #fff;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n  font-size: 16px;\n  line-height: 1.6;\n}\n\n.load-more-button {\n  width: 100%;\n  padding: 12px;\n  background-color: var(--success-color);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.load-more-button:hover {\n  background-color: #218838;\n}\n\n@media (max-width: 600px) {\n  .search-input {\n    width: 70%;\n  }\n\n  .search-button {\n    width: 28%;\n  }\n}\n</style>\n"],"names":["_sfc_main","trimmedQuery","response","choiceContents","choice","error","query","apiKey","url","headers","data","markdownText","boldRegex","html","_hoisted_1","_hoisted_2","_openBlock","_createElementBlock","_createElementVNode","$data","$event","$options","args","_hoisted_4","_hoisted_5","_cache","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","answer","index"],"mappings":"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"}